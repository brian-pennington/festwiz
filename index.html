<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fest Wizard</title>
  <link rel="stylesheet" href="style.css">
  <link rel="manifest" href="/manifest.json">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
</head>
<body>

  <!-- HEADER -->
  <header class="header">
    <div class="header__brand">
      <div class="header__title">FestWiz</div>
      <div class="page-toggle">
        <a href="/" class="page-toggle__half page-toggle__artist active">Artists</a>
        <a href="/schedule" class="page-toggle__half page-toggle__schedule" id="btn-schedule">Schedule</a>
      </div>
    </div>
    <button class="hamburger-btn" id="artist-hamburger-btn" aria-label="Open menu">
      <span></span><span></span><span></span>
    </button>
    <div class="header__stats">
      <div>Rated: <span class="header__stat-value" id="stat-rated">0</span> / <span id="stat-total">0</span></div>
      <div>Unrated: <span class="header__stat-value" id="stat-remaining">0</span></div>
      <div>Showing: <span class="header__stat-value" id="stat-showing">0</span></div>
    </div>
    <div class="artist-controls">
      <button class="btn" id="btn-add-artist">+ Add Artist</button>
      <button class="btn" id="btn-genre-tiers">Genre Tiers</button>
      <button class="btn" id="btn-subgenre-tiers">Subgenre Tiers</button>
      <button class="btn" id="btn-export">Export</button>
      <button class="btn" id="btn-import">Import</button>
      <button class="btn" id="btn-share">Share</button>
      <div class="theme-toggle-3" id="btn-theme">
        <button class="theme-seg" data-theme="system">Auto</button>
        <button class="theme-seg" data-theme="light">&#9788;</button>
        <button class="theme-seg" data-theme="dark">&#9790;</button>
      </div>
    </div>
  </header>
  <div class="artist-drawer-backdrop" id="artist-drawer-backdrop"></div>

  <!-- LAYOUT -->
  <div class="layout">

    <!-- SIDEBAR -->
    <aside class="sidebar">
      <div class="sidebar__section">
        <div class="sidebar__heading">Search</div>
        <input type="text" class="search-input" id="search-input" placeholder="Search artists...">
      </div>

      <div class="sidebar__section">
        <div class="sidebar__heading">Show</div>
        <div class="filter-group" id="filter-rated">
          <button class="filter-btn active" data-filter="all">All</button>
          <button class="filter-btn" data-filter="unrated">Unrated</button>
          <button class="filter-btn" data-filter="rated">Rated</button>
          <button class="filter-btn" data-filter="3+">3+4 Only</button>
        </div>
      </div>

      <div class="sidebar__section">
        <div class="sidebar__heading">Source</div>
        <div class="filter-group" id="filter-source">
          <button class="filter-btn active" data-filter="all">All</button>
          <button class="filter-btn" data-filter="official">Official</button>
          <button class="filter-btn" data-filter="unofficial">Unofficial</button>
          <button class="filter-btn" data-filter="user">User-Submitted</button>
        </div>
      </div>

      <div class="sidebar__section">
        <div class="sidebar__heading">Sort</div>
        <div class="filter-group" id="filter-sort">
          <button class="filter-btn active" data-sort="name">Name</button>
          <button class="filter-btn" data-sort="genre">Genre</button>
          <button class="filter-btn" data-sort="subgenre">Subgenre</button>
          <button class="filter-btn" data-sort="rating">Rating</button>
          <button class="filter-btn" data-sort="country">Country</button>
        </div>
      </div>

      <div class="sidebar__section">
        <div class="sidebar__heading sidebar__heading--toggle" id="toggle-genres">Genres <span class="sidebar__arrow">&#9660;</span></div>
        <ul class="genre-list" id="genre-list"></ul>
      </div>

      <div class="sidebar__section">
        <div class="sidebar__heading sidebar__heading--toggle" id="toggle-subgenres">Subgenres <span class="sidebar__arrow">&#9660;</span></div>
        <ul class="genre-list" id="subgenre-list"></ul>
      </div>
    </aside>

    <!-- MAIN CONTENT -->
    <main class="main" id="main-content">
      <div class="loading" id="loading">Loading artists.json...</div>
    </main>
  </div>

  <!-- ADD ARTIST MODAL -->
  <div class="modal-overlay" id="modal-add-artist">
    <div class="modal">
      <div class="modal__title">Add Artist</div>
      <div class="form-group">
        <label>Artist Name *</label>
        <input type="text" id="add-name" required>
      </div>
      <div class="form-group">
        <label>Genre</label>
        <input type="text" id="add-genre" placeholder="e.g. Rock">
      </div>
      <div class="form-group">
        <label>Subgenre</label>
        <input type="text" id="add-subgenre" placeholder="e.g. Post-Punk">
      </div>
      <div class="form-group">
        <label>Location</label>
        <input type="text" id="add-location" placeholder="e.g. Austin, TX">
      </div>
      <div class="form-group">
        <label>Description</label>
        <textarea id="add-description" rows="3"></textarea>
      </div>
      <div class="form-group">
        <label>Bandcamp URL</label>
        <input type="url" id="add-bandcamp" placeholder="https://...bandcamp.com">
      </div>
      <div class="form-group">
        <label>YouTube URL</label>
        <input type="url" id="add-youtube" placeholder="https://youtube.com/...">
      </div>
      <div class="form-group">
        <label>Apple Music URL</label>
        <input type="url" id="add-apple-music" placeholder="https://music.apple.com/...">
      </div>
      <div class="form-group">
        <label>SoundCloud URL</label>
        <input type="url" id="add-soundcloud" placeholder="https://soundcloud.com/...">
      </div>
      <div class="form-group">
        <label>Spotify URL</label>
        <input type="url" id="add-spotify" placeholder="https://open.spotify.com/...">
      </div>
      <div class="form-group">
        <label>Website URL</label>
        <input type="url" id="add-website" placeholder="https://...">
      </div>
      <div class="modal__actions">
        <button class="btn" id="btn-cancel-add">Cancel</button>
        <button class="btn btn--accent" id="btn-save-add">Add Artist</button>
      </div>
    </div>
  </div>

  <!-- GENRE TIERS MODAL -->
  <div class="modal-overlay" id="modal-genre-tiers">
    <div class="modal" style="width: 600px">
      <div class="modal__title">Set Genre Priority Tiers</div>
      <p style="font-size: 13px; color: var(--text-muted); margin-bottom: 16px;">
        Assign priority tiers to focus your listening. High = review first, Skip = hide entirely.
      </p>
      <div id="genre-tier-list"></div>
      <div class="modal__actions">
        <button class="btn" id="btn-close-tiers">Close</button>
      </div>
    </div>
  </div>

  <!-- SUBGENRE TIERS MODAL -->
  <div class="modal-overlay" id="modal-subgenre-tiers">
    <div class="modal" style="width: 600px">
      <div class="modal__title">Set Subgenre Priority Tiers</div>
      <p style="font-size: 13px; color: var(--text-muted); margin-bottom: 16px;">
        Assign priority tiers to subgenres. High = review first, Skip = hide entirely.
      </p>
      <div id="subgenre-tier-list"></div>
      <div class="modal__actions">
        <button class="btn" id="btn-close-subgenre-tiers">Close</button>
      </div>
    </div>
  </div>

  <!-- EXPORT CHOICE MODAL -->
  <div class="modal-overlay" id="modal-export-choice">
    <div class="modal">
      <div class="modal__title">Export</div>
      <div class="modal__actions" style="flex-direction: column; gap: 10px; align-items: stretch;">
        <button class="btn btn--accent" id="btn-export-shortlist">Shortlist (CSV) — highest-rated artists for sharing</button>
        <button class="btn" id="btn-export-all">Full Backup (JSON) — all ratings &amp; notes</button>
        <button class="btn" id="btn-cancel-export">Cancel</button>
      </div>
    </div>
  </div>

  <!-- ANNOUNCEMENT MODAL -->
  <div class="modal-overlay" id="modal-announcements">
    <div class="modal">
      <div class="ann-header">
        <button class="btn ann-nav-btn" id="ann-prev">← Newer</button>
        <div class="ann-meta">
          <span class="ann-date" id="ann-date"></span>
          <span class="ann-counter" id="ann-counter"></span>
        </div>
        <button class="btn ann-nav-btn" id="ann-next">Older →</button>
      </div>
      <div class="modal__title" id="ann-title"></div>
      <div class="ann-body" id="ann-body"></div>
      <div class="modal__actions">
        <button class="btn btn--accent" id="ann-close">Close</button>
      </div>
    </div>
  </div>

  <!-- TUTORIAL MODAL -->
  <div class="modal-overlay" id="modal-tutorial">
    <div class="modal modal--tutorial">
      <div class="modal__title">Welcome to FestWiz</div>
      <div class="tutorial-body">
        <p>Welcome to FestWiz. I created this app to help me rate bands coming to Austin and catch as many bands live as I could. FestWiz is free to use, it's a labor of love. The idea is to spend some time pre-fest determining which bands you like (or load ratings from a friend whose taste you trust), and once shows begin, share those ratings to your phone where you'll be able to tell where the bands you like best are playing across town. All your ratings will be saved in your browser's local storage, and you can also share your ratings with your phone so that it's up to date. Once you've rated some artists, you'll be able to display a grid or list of just the artists you liked best.</p>
        <h3>Rating Bands</h3>
        <p>Hopefully this is pretty easy to understand! I find the subgenres more useful than the genres personally. Use filters and sorting to rate every post-punk band, every band from Ireland, or every band whose name contains the letter Z. If there's a band I'm missing that you want to track, you can add them in yourself with the <strong>+Add Artist</strong> button.</p>
        <h3>Genre &amp; Subgenre Tiers</h3>
        <p>Use <strong>Genre Tiers</strong> and <strong>Subgenre Tiers</strong> to prioritize what you listen to. I don't think any of us will have time to listen to 800+ artists, so check out performers who play genres you like, or who are playing shows with other acts you're into. Like rating a band, you can always change these at any time.</p>
        <h3>Schedule</h3>
        <p>Switch to the <strong>Schedule</strong> page to see all shows on a grid organized by venue and time slot. Tap any performer to see details and update your rating. In all modes you can filter by how highly you rated an artist and admission type (Free, Paid, Badge).</p>
        <p>I used to make a giant spreadsheet of all the shows I wanted to see and <strong>Grid</strong> view mimics this. <strong>Now</strong> view is intended for a quick glance on your phone to see which artists are about to go on and let you make some quick decisions on where to go. To be quite honest, I'm not quite sure what <strong>Cloud</strong> view is going to do. Maybe it will be a way for you to see a lot of info on who's playing at a glance, in a zeitgeisty kind of way. Right now it doesn't work too well but maybe I'll have some time to polish it up.</p>
        <h3>Sharing Your Ratings</h3>
        <p>Click <strong>Share</strong> to generate a URL containing your ratings. This is how you can get your ratings from a desktop computer to your phone. Also you can send this link to a friend — when they open the link they'll be prompted to import your ratings so they can benefit from how excellent your taste in music is.</p>
        <h3>Exporting</h3>
        <p>The <strong>Export</strong> button gives you two options:</p>
        <ul>
          <li><strong>Shortlist (CSV)</strong> exports your top rated (3 or 4) artists and one link for each of them, if you want to share.</li>
          <li><strong>Full Backup (JSON)</strong> will save all your ratings for you to back up or load somewhere else like another browser. If you're trying to get your phone or a friend to see your ratings, use the share function instead, it will work better.</li>
        </ul>

        <h3>Adding Shows</h3>
        <p>On the Schedule page, use <strong>+ Shows</strong> to manually add unofficial showcases or day parties that you don't see in our grid. I will be adding shows to this list continuously, but I'm just one person so I might miss stuff, and this is your way to add in things on your own.</p>
      </div>
      <div class="modal__actions">
        <button class="btn btn--accent" id="btn-close-tutorial">ZAP!</button>
      </div>
    </div>
  </div>

  <!-- HELP FAB -->
  <button class="help-fab" id="btn-help" aria-label="Help">?</button>

  <!-- Hidden file input for import -->
  <input type="file" id="import-file-input" accept=".json" style="display: none">

  <script src="app.js"></script>
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/service-worker.js');
    }
  </script>
</body>
</html>
