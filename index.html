<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fest Wizard</title>
  <link rel="stylesheet" href="style.css">
  <link rel="manifest" href="/manifest.json">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
</head>
<body>

  <!-- HEADER -->
  <header class="header">
    <div class="header__brand">
      <div class="header__title" id="btn-about"><svg class="site-logo" viewBox="0 0 139 36" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M118.82 19.5V16.25H122.07V19.5H118.82ZM131.82 29.25H135.07V32.5H131.82H128.57H125.32H122.07H118.82V29.25H122.07V26H125.32V22.75V19.5H128.57V16.25H125.32H122.07V13H125.32H128.57H131.82H135.07V16.25V19.5H131.82V22.75V26H128.57V29.25H131.82ZM135.07 29.25V26H138.32V29.25H135.07Z" fill="#BB124D"/><path d="M112.32 32.5H109.07V29.25H105.82V26V22.75V19.5V16.25H109.07V13H112.32V16.25V19.5V22.75V26V29.25H115.57V32.5H112.32ZM109.07 13H105.82V9.75V6.5H109.07V3.25H112.32V6.5V9.75H109.07V13Z" fill="#BB124D"/><path d="M92.82 32.5H89.57V29.25H86.32V32.5H83.07H79.82V29.25H76.57V26V22.75V19.5V16.25V13V9.75V6.5H73.32V3.25H76.57H79.82V0H83.07V3.25V6.5V9.75V13V16.25V19.5V22.75V26V29.25H86.32V26V22.75V19.5V16.25V13V9.75V6.5V3.25H89.57V0H92.82V3.25V6.5V9.75V13V16.25V19.5V22.75V26V29.25H96.07V32.5H92.82ZM96.07 29.25V26V22.75V19.5V16.25V13V9.75V6.5V3.25H99.32V0H102.57V3.25V6.5V9.75V13V16.25V19.5V22.75V26H99.32V29.25H96.07Z" fill="#BB124D"/><path d="M66.82 32.5H63.57V29.25H60.32V26V22.75V19.5V16.25H57.07V13H60.32V9.75V6.5V3.25H63.57V0H66.82V3.25V6.5V9.75V13H70.07V16.25H66.82V19.5V22.75V26V29.25H70.07V32.5H66.82Z" fill="#BB124D"/><path d="M47.32 32.5H44.07H40.82V29.25H44.07H47.32V26H44.07V22.75H40.82V19.5H37.57V16.25H40.82V13H44.07H47.32H50.57V16.25V19.5H47.32V16.25H44.07V19.5H47.32V22.75H50.57H53.82V26V29.25H50.57V32.5H47.32ZM40.82 29.25H37.57V26H40.82V29.25Z" fill="#BB124D"/><path d="M27.82 29.25H31.07V32.5H27.82H24.57H21.32V29.25H18.07V26V22.75V19.5H21.32V16.25H24.57V19.5V22.75H27.82V26H24.57V29.25H27.82ZM31.07 29.25V26H34.32V29.25H31.07ZM27.82 22.75V19.5V16.25H24.57V13H27.82H31.07H34.32V16.25V19.5H31.07V22.75H27.82Z" fill="#BB124D"/><path d="M3.25 35.75V32.5V29.25V26V22.75V19.5H0V16.25H3.25V13V9.75V6.5H0V3.25H3.25H6.5H9.75V0H13H16.25V3.25H19.5V6.5V9.75H16.25V6.5H13V9.75H9.75V13H13H16.25V16.25H13V19.5H9.75V22.75V26V29.25V32.5H6.5V35.75H3.25Z" fill="#BB124D"/></svg></div>
      <div class="page-toggle">
        <a href="/" class="page-toggle__half page-toggle__artist active">Rate</a>
        <a href="/schedule" class="page-toggle__half page-toggle__schedule" id="btn-schedule">Schedule</a>
      </div>
    </div>
    <button class="hamburger-btn" id="artist-hamburger-btn" aria-label="Open menu">
      <span></span><span></span><span></span>
    </button>
    <div class="header__stats">
      <div>Rated: <span class="header__stat-value" id="stat-rated">0</span> / <span id="stat-total">0</span></div>
      <div>Unrated: <span class="header__stat-value" id="stat-remaining">0</span></div>
      <div>Showing: <span class="header__stat-value" id="stat-showing">0</span></div>
    </div>
    <div class="artist-controls">
      <button class="btn" id="btn-add-artist">+ Add Artist</button>
      <button class="btn" id="btn-export">Export</button>
      <button class="btn" id="btn-import">Import</button>
      <button class="btn" id="btn-share">Share</button>
      <button class="btn" id="btn-updates">Updates</button>
      <div class="theme-toggle-3" id="btn-theme">
        <button class="theme-seg" data-theme="system">Auto</button>
        <button class="theme-seg" data-theme="light">&#9788;</button>
        <button class="theme-seg" data-theme="dark">&#9790;</button>
      </div>
    </div>
  </header>
  <div class="artist-drawer-backdrop" id="artist-drawer-backdrop"></div>

  <!-- LAYOUT -->
  <div class="layout">

    <!-- SIDEBAR -->
    <aside class="sidebar">
      <div class="sidebar__section">
        <div class="sidebar__heading">Search</div>
        <input type="text" class="search-input" id="search-input" placeholder="Search artists...">
      </div>

      <div class="sidebar__section">
        <div class="sidebar__heading">Show</div>
        <div class="filter-group" id="filter-rated">
          <button class="filter-btn active" data-filter="all">All</button>
          <button class="filter-btn" data-filter="unrated">Unrated</button>
          <button class="filter-btn" data-filter="rated">Rated</button>
          <button class="filter-btn" data-filter="3+">3+4 Only</button>
        </div>
      </div>

      <div class="sidebar__section">
        <div class="sidebar__heading">Source</div>
        <div class="filter-group" id="filter-source">
          <button class="filter-btn active" data-filter="all">All</button>
          <button class="filter-btn" data-filter="official">Official</button>
          <button class="filter-btn" data-filter="unofficial">Unofficial</button>
          <button class="filter-btn" data-filter="user">User-Submitted</button>
        </div>
      </div>

      <div class="sidebar__section">
        <div class="sidebar__heading">Sort</div>
        <div class="filter-group" id="filter-sort">
          <button class="filter-btn active" data-sort="name">Name</button>
          <button class="filter-btn" data-sort="genre">Genre</button>
          <button class="filter-btn" data-sort="subgenre">Subgenre</button>
          <button class="filter-btn" data-sort="rating">Rating</button>
          <button class="filter-btn" data-sort="country">Country</button>
        </div>
      </div>

      <div class="sidebar__section">
        <div class="sidebar__heading sidebar__heading--toggle" id="toggle-genres">Genres <span class="sidebar__arrow">&#9660;</span></div>
        <ul class="genre-list" id="genre-list"></ul>
      </div>

      <div class="sidebar__section">
        <div class="sidebar__heading sidebar__heading--toggle" id="toggle-subgenres">Subgenres <span class="sidebar__arrow">&#9660;</span></div>
        <ul class="genre-list" id="subgenre-list"></ul>
      </div>

      <div class="sidebar__section sidebar__section--tiers">
        <button class="btn sidebar-tier-btn" id="btn-genre-tiers">Genre Tiers</button>
        <button class="btn sidebar-tier-btn" id="btn-subgenre-tiers">Subgenre Tiers</button>
      </div>
    </aside>

    <!-- MAIN CONTENT -->
    <main class="main" id="main-content">
      <div class="loading" id="loading">Loading artists.json...</div>
    </main>
  </div>

  <!-- ADD ARTIST MODAL -->
  <div class="modal-overlay" id="modal-add-artist">
    <div class="modal">
      <div class="modal__title">Add Artist</div>
      <div class="form-group">
        <label>Artist Name *</label>
        <input type="text" id="add-name" required>
      </div>
      <div class="form-group">
        <label>Genre</label>
        <input type="text" id="add-genre" placeholder="e.g. Rock">
      </div>
      <div class="form-group">
        <label>Subgenre</label>
        <input type="text" id="add-subgenre" placeholder="e.g. Post-Punk">
      </div>
      <div class="form-group">
        <label>Location</label>
        <input type="text" id="add-location" placeholder="e.g. Austin, TX">
      </div>
      <div class="form-group">
        <label>Description</label>
        <textarea id="add-description" rows="3"></textarea>
      </div>
      <div class="form-group">
        <label>Bandcamp URL</label>
        <input type="url" id="add-bandcamp" placeholder="https://...bandcamp.com">
      </div>
      <div class="form-group">
        <label>YouTube URL</label>
        <input type="url" id="add-youtube" placeholder="https://youtube.com/...">
      </div>
      <div class="form-group">
        <label>Apple Music URL</label>
        <input type="url" id="add-apple-music" placeholder="https://music.apple.com/...">
      </div>
      <div class="form-group">
        <label>SoundCloud URL</label>
        <input type="url" id="add-soundcloud" placeholder="https://soundcloud.com/...">
      </div>
      <div class="form-group">
        <label>Spotify URL</label>
        <input type="url" id="add-spotify" placeholder="https://open.spotify.com/...">
      </div>
      <div class="form-group">
        <label>Website URL</label>
        <input type="url" id="add-website" placeholder="https://...">
      </div>
      <div class="modal__actions">
        <button class="btn" id="btn-cancel-add">Cancel</button>
        <button class="btn btn--accent" id="btn-save-add">Add Artist</button>
      </div>
    </div>
  </div>

  <!-- GENRE TIERS MODAL -->
  <div class="modal-overlay" id="modal-genre-tiers">
    <div class="modal" style="width: 600px">
      <div class="modal__title">Set Genre Priority Tiers</div>
      <p style="font-size: 13px; color: var(--text-muted); margin-bottom: 16px;">
        Assign priority tiers to focus your listening. High = review first, Skip = hide entirely.
      </p>
      <div id="genre-tier-list"></div>
      <div class="modal__actions">
        <button class="btn" id="btn-close-tiers">Close</button>
      </div>
    </div>
  </div>

  <!-- SUBGENRE TIERS MODAL -->
  <div class="modal-overlay" id="modal-subgenre-tiers">
    <div class="modal" style="width: 600px">
      <div class="modal__title">Set Subgenre Priority Tiers</div>
      <p style="font-size: 13px; color: var(--text-muted); margin-bottom: 16px;">
        Assign priority tiers to subgenres. High = review first, Skip = hide entirely.
      </p>
      <div id="subgenre-tier-list"></div>
      <div class="modal__actions">
        <button class="btn" id="btn-close-subgenre-tiers">Close</button>
      </div>
    </div>
  </div>

  <!-- EXPORT CHOICE MODAL -->
  <div class="modal-overlay" id="modal-export-choice">
    <div class="modal">
      <div class="modal__title">Export</div>
      <div class="modal__actions" style="flex-direction: column; gap: 10px; align-items: stretch;">
        <button class="btn btn--accent" id="btn-export-shortlist">Shortlist (CSV) — highest-rated artists for sharing</button>
        <button class="btn" id="btn-export-all">Full Backup (JSON) — all ratings &amp; notes</button>
        <button class="btn" id="btn-cancel-export">Cancel</button>
      </div>
    </div>
  </div>

  <!-- ANNOUNCEMENT MODAL -->
  <div class="modal-overlay" id="modal-announcements">
    <div class="modal">
      <div class="ann-header">
        <button class="btn ann-nav-btn" id="ann-prev">← Newer</button>
        <div class="ann-meta">
          <span class="ann-date" id="ann-date"></span>
          <span class="ann-counter" id="ann-counter"></span>
        </div>
        <button class="btn ann-nav-btn" id="ann-next">Older →</button>
      </div>
      <div class="modal__title" id="ann-title"></div>
      <div class="ann-body" id="ann-body"></div>
      <div class="modal__actions">
        <button class="btn btn--accent" id="ann-close">ZAP!</button>
      </div>
    </div>
  </div>

  <!-- TUTORIAL MODAL -->
  <div class="modal-overlay" id="modal-tutorial">
    <div class="modal modal--tutorial">
      <div class="modal__title">Welcome to FestWiz</div>
      <div class="tutorial-body">
        <p><em>(Click the <strong>?</strong> icon in the lower right to return to this tutorial)</em></p>
        <p>Welcome to FestWiz. FestWiz is free to use. The idea is to spend some time pre-fest determining which bands you like by listening and rating (or load ratings from a friend whose taste you trust), and once shows begin, share those ratings to your phone where you'll be able to tell where the bands you like best are playing across town. All your ratings will be saved in your browser's local storage, and you can also share your ratings with your phone so that it's up to date. Once you've rated some artists, you'll be able to display a grid or list of just the artists you liked best.</p>
        <h3>Rating Bands</h3>
        <p>Hopefully this is pretty easy to understand! Use filters and sorting to rate every post-punk band, every band from Ireland, or every band whose name contains the letter Z. If there's a band I'm missing that you want to track, you can add them in yourself with the <strong>+Add Artist</strong> button.</p>
        <h3>Genre &amp; Subgenre Tiers</h3>
        <p>Use <strong>Genre Tiers</strong> and <strong>Subgenre Tiers</strong> to prioritize what you listen to. I find the subgenres more useful than the genres personally. I don't think any of us will have time to listen to 800+ artists, so check out performers who play genres you like, or who are playing shows with other acts you're into. Like rating a band, you can always change these tiers at any time.</p>
        <h3>Schedule</h3>
        <p>Switch to the <strong>Schedule</strong> page to see all shows on a grid organized by venue and time slot. Tap any performer to see details and update your rating. In all modes you can filter by how highly you rated an artist and admission type (Free, Paid, Badge).</p>
        <p>I used to make a giant spreadsheet of all the shows I wanted to see and <strong>Grid</strong> view mimics this. <strong>Now</strong> view is intended for a quick glance on your phone to see which artists are about to go on and let you make some quick decisions on where to go. To be quite honest, I'm not quite sure what <strong>Cloud</strong> view is going to do. Maybe it will be a way for you to see a lot of info on who's playing at a glance, in a zeitgeisty kind of way. Right now it doesn't work too well but maybe I'll have some time to polish it up.</p>
        <h3>Sharing Your Ratings</h3>
        <p>Click <strong>Share</strong> to generate a URL that contains your ratings. This is how you can get your ratings from a desktop computer to your phone. Open that URL on your phone and magically your ratings can be imported. Also you can send this link to a friend — when they open the link they'll be prompted to import your ratings so they can benefit from how excellent your taste in music is.</p>
        <h3>Exporting</h3>
        <p>The <strong>Export</strong> button gives you two options:</p>
        <ul>
          <li><strong>Shortlist (CSV)</strong> exports your top rated (3 or 4) artists and one link for each of them, if you want to share them with someone but don't want to overwhelm them with this whole app thing.</li>
          <li><strong>Full Backup (JSON)</strong> will save all your ratings for you to back up or load somewhere else like another browser. If you're trying to get your phone or a friend to see your ratings, use the share function instead, it will work better.</li>
        </ul>
        <h3>Adding Shows</h3>
        <p>On the Schedule page, use <strong>+ Shows</strong> to manually add unofficial showcases or day parties that you don't see in our grid. I will be adding shows to our list continuously, but I'm just one person so I might miss stuff, and this is your way to add in things on your own.</p>
      </div>
      <div class="modal__actions">
        <button class="btn btn--accent" id="btn-close-tutorial">ZAP!</button>
      </div>
    </div>
  </div>

  <!-- ABOUT MODAL -->
  <div class="modal-overlay" id="modal-about">
    <div class="modal">
      <div class="modal__title">About FestWiz</div>
      <div class="tutorial-body">
        <p>I'm Brian. I created FestWiz to help me rate bands coming to Austin and catch as many bands live as I could. Every year for many running I've spent hours and hours poring over which bands I liked and built a big ol online spreadsheet full of every show I can find. This year I decided if I'm going to spending that much time anyway I may as well get something other people can use.</p>
        <p>I want to be up front, I did use an LLM to help me build this app. I am a web developer and in theory I could have done, if not all of this myself, well a bunch of it. But I wouldn't have, as it would have taken me way more time than this did and time is already in short supply. For me this is the perfect kind of project for AI, but I do want to acknowledge there are a LOT of societal problems going on with AI and this is feeding in to it.</p>
        <p>As I am doing this in my free time and I have a job and at least 600 more bands to listen to, I cannot provide reliable tech support, but I'll try to help if something goes wrong.</p> 
        <p>I will not be asking for any money for FestWiz despite friends telling me I could. If you want to do something supportive, you could subscribe to the <a href="https://liteandbriteatx.com/" target="_blank">newsletter of offbeat Austin events</a> I produce with my partner, <a href="https://kpiss.fm/show/no-humans-allowed" target="_blank">listen to my radio show</a> on <a href="https://kpiss.fm" target="_blank">Kpiss.fm</a> (the Golden Stream), or tell a friend about this app.</p>
        <p>— Brian</p>
      </div>
      <div class="modal__actions">
        <button class="btn btn--accent" id="btn-close-about">Close</button>
      </div>
    </div>
  </div>

  <!-- HELP FAB -->
  <button class="help-fab" id="btn-help" aria-label="Help">?</button>

  <!-- Hidden file input for import -->
  <input type="file" id="import-file-input" accept=".json" style="display: none">

  <script src="app.js"></script>
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/service-worker.js');
    }
  </script>
</body>
</html>
